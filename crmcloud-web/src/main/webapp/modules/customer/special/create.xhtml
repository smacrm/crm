<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    <style>
        .div_panelGridDialog {
            overflow-y: auto;
            padding: 0 !important;
        }

        .panelGridDialog {
            width: 100%;
            border-width: 1px !important;
            border-color:inherit;
            line-height: 1.5em !important;
            white-space: nowrap !important;
        }
        
        .panelGridDialog label {
            white-space: normal !important;
            word-break: break-word !important;
        }

        .panelGridDialog td a {
            margin-top: -0.2em;
            margin-left: 0.2em;
        }
        .panelGridDialog font {
            color: red !important;
        }
    </style>
    
    <h:outputScript library="js" name="select-level.js"/>
    
    <div id="pageTitle">
        #{issue['label.cust_special']}#{msg['symbol.paren.left']}#{msg['label.create']}#{msg['symbol.paren.right']}
    </div>
    <h:form id="form_special_customer" prependId="false" onkeypress="if (event.keyCode === 13 &amp;&amp; $(event.target).prop('tagName') !== 'TEXTAREA') { return false; }">
        <h:panelGrid width="100%" styleClass="page-header">
            <f:facet name="header">
                <div class="row">
                    <div class="col-md-6">
                        <h1>${issue['label.cust_special']}<small>${msg['label.create']}</small></h1>
                    </div>
                    <div class="col-md-6 text-right">
                        
                        <!-- khi hủy quá trình tạo mới khách hàng cần unhold khách hàng mới này. -->
                        <p:commandButton
                            id="btnBack"
                            value="${msg['label.cancel']}"
                            actionListener="#{projectController.goback()}"
                            icon="fa fa-chevron-circle-left"
                            update="mainContent"
                            process="@this"
                            onstart="start()" onsuccess="finish()">
                            <h:inputHidden value="${projectController.listId}" />
                            <f:actionListener binding="#{customerController.unHoldCustomer()}"/>
                            <f:param name="custId" value="0"/>
                            <f:param name="force" value="true"/>
                            <p:confirm header="#{msg['label.confirm']}" message="#{msg['label.message.confirm.back']}" icon="ui-icon-alert"/>
                        </p:commandButton>
                        
                        <c:choose>
                            <c:when test="#{customerController.customer.custId == null or customerController.customer.custId == 0}">
                                <p:commandButton onstart="start()" onsuccess="finish()" icon="fa fa-save" value="#{msg['label.new_application']}" styleClass="button_padding_05"
                                                 actionListener="${customerController.insertSpecialCust(1)}" update="mainContent, :growl">
                                    <f:param name="custId" value="#{customerController.customer.custId}"/>
                                    <f:param name="force" value="true"/>
                                </p:commandButton>
                            </c:when>
                            <c:when test="#{customerController.customer.custId != null and customerController.customer.custStatus == null}">
                                <p:commandButton onstart="start()" onsuccess="finish()" icon="fa fa-check-circle" value="#{msg['label.correction_application']}" styleClass="button_padding_05"
                                                 actionListener="#{customerController.updateSpecialCust(1,1)}" update="mainContent, :growl">
                                    <f:param name="custId" value="#{customerController.customer.custId}"/>
                                    <f:param name="force" value="true"/>
                                </p:commandButton>
                                <p:commandButton onstart="start()" onsuccess="finish()" icon="fa fa-check-circle" value="#{msg['label.apply_deletion']}" styleClass="button_padding_05"
                                                 actionListener="#{customerController.updateSpecialCust(2,1)}" update="mainContent, :growl">
                                    <f:param name="custId" value="#{customerController.customer.custId}"/>
                                    <f:param name="force" value="true"/>
                                </p:commandButton>
                            </c:when>
                            <c:otherwise>
                                <p:commandButton onstart="start()" onsuccess="finish()" icon="fa fa-check-circle" value="#{msg['label.pending']}" styleClass="button_padding_05"
                                                 actionListener="#{customerController.updateSpecialCust(3,1)}" update="mainContent, :growl">
                                    <f:param name="custId" value="#{customerController.customer.custId}"/>
                                    <f:param name="force" value="true"/>
                                </p:commandButton>
                                <p:commandButton onstart="start()" onsuccess="finish()" icon="fa fa-check-circle" value="#{msg['label.approval']}" styleClass="button_padding_05"
                                                 actionListener="#{customerController.updateSpecialCust(4,1)}" update="mainContent, :growl">
                                    <f:param name="custId" value="#{customerController.customer.custId}"/>
                                    <f:param name="force" value="true"/>
                                </p:commandButton>
                                <p:commandButton onstart="start()" onsuccess="finish()" icon="fa fa-check-circle" value="#{msg['label.not_show']}" styleClass="button_padding_05"
                                                 actionListener="#{customerController.updateSpecialCust(5,1)}" update="mainContent, :growl">
                                    <f:param name="custId" value="#{customerController.customer.custId}"/>
                                    <f:param name="force" value="true"/>
                                </p:commandButton>
                            </c:otherwise>
                        </c:choose>
                    </div>
                </div>
            </f:facet>
        </h:panelGrid>
        
        
        <p:outputPanel id="special_customer_block" styleClass="box box-view-mode"> <!-- box-view-mode -->
            <div class="box-body">
                <ui:include src="/modules/customer/special/common/form_input.xhtml">
                    <ui:param name="custId" value="#{customerController.customer.custId}" />
                </ui:include>    
            </div>
        </p:outputPanel>
    </h:form>
</ui:composition>
