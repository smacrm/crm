<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
    <c:set var="itemCount" value="0" scope="request" />
    <c:forEach items="${list}" var="p" rendered="#{sec.hasMethod('ProjectController', 'search')}">
        <c:set var="itemCount" value="#{itemCount + 1}"/>
        <li class="#{projectController.project eq p ? 'side-bar-active' : ''}">
            <p:commandLink update="mainContent, #{layout.componentForUpdateInSiderbarLeft}" onstart="start()" onsuccess="finish()"
                           actionListener="${projectController.search(p)}" oncomplete="CRMCLOUD.show_project_item_action();">
                <i class="fa fa-circle-o"></i>
                <span style="white-space: normal !important; word-break: break-word !important;">${p.listName}</span>
                <f:param name="force" value="true"/>
            </p:commandLink>
            <p:commandLink actionListener="#{projectController.update(p)}" styleClass="edit-project-item-action" oncomplete="CRMCLOUD.show_project_item_action();"
                           update="mainContent, #{layout.componentForUpdateInSiderbarLeft}" onstart="start()" onsuccess="finish()"
                           style="display: none">
                <f:param name="force" value="true"/>
            </p:commandLink>
            <h:outputText styleClass="project-item-action edit-project-item fa fa-pencil" style="display: none" 
                          rendered="#{p.creator.memberId eq loginController.member.userId and sec.hasMethod('ProjectController', 'update')}"/>
        </li>
    </c:forEach>
    <c:if test="#{itemCount eq 0}">
        <li><h6 class="text-warning text-center"><i>#{msg['label.data.empty']}</i></h6></li>
    </c:if>
    <script>
        jQuery(document).ready(function(){
            $("#sidebar-menu .edit-project-item").off("click").click(function(){
                $(this).parent().find(".edit-project-item-action").trigger('click');
            });
        });
    </script>
</ui:composition>

