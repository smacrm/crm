<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <f:view locale="#{localeController.locale}">
        <h:head>
            <title>#{mailBundle['label.sent.dialog.from_issue']}</title>
            <h:outputStylesheet library="css" name="dialog_growl.css"  />
            <h:outputStylesheet library="css" name="dialog.css"  />
            <h:outputScript library="js" name="add-checkbox-menu.js"/>
            <style type="text/css">
                .ui-fileupload .ui-fileupload-buttonbar {
                    background: none;
                    border: none;
                }
                .ui-fileupload-content {
                    background: none;
                    border: none;
                }
            </style>
        </h:head>
        <h:body>
            <h:form id="form_todo" prependId="false">
                <p:growl id="dialog_growl" showDetail="false" life="3000" />
                <p:panelGrid style="width: 100%;" styleClass="panelGridDialog">
                    <p:row>
                        <p:column colspan="2" style="text-align: center !important">
                            <p:commandButton value="#{mailBundle['label.sent.dialog.button.send']}" onstart="start()" onsuccess="finish()"
                                             actionListener="#{sendEmailController.onSendEmail()}" />
                            <p:commandButton value="#{mailBundle['label.sent.dialog.button.to_cc']}" disabled="true"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column styleClass="td_15 td_text_align_left">
                            <h:outputLabel value="#{msg['label.mail.from']}" />
                        </p:column>
                        <p:column styleClass="td_text_align_left">
                            <p:selectOneMenu value="#{sendEmailController.mailToId}" >
                                <f:selectItems value="#{sendEmailController.lstMailTo}"/>
                            </p:selectOneMenu>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column styleClass="td_15 td_text_align_left">
                            <h:outputLabel value="#{msg['label.mail.to']}" />
                        </p:column>
                        <p:column styleClass="td_text_align_left">
                            <p:commandButton id="sendemail_to" type="button" icon="fa fa-th" styleClass="menu-toggle" />
                            <label id="label_sendemail_to" class="font_weight_normal" >${sendEmailController.issue.creatorPersonName}</label>
                            <p:tieredMenu
                                overlay="true"
                                trigger="sendemail_to"
                                widgetVar="widget_sendemail_to"
                                my="left top"
                                at="left bottom"
                                model="#{issueController.selects.get('d_o_users')}"
                                styleClass="tieredMenu_d_o_users"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column styleClass="td_15 td_text_align_left">
                            <h:outputLabel value="#{msg['label.mail.cc']}" />
                        </p:column>
                        <p:column styleClass="td_text_align_left">
                            <p:commandButton id="sendemail_cc" type="button" icon="fa fa-th" styleClass="menu-toggle" />
                            <label id="label_sendemail_cc" class="font_weight_normal" >${sendEmailController.issue.creatorPersonName}</label>
                            <p:tieredMenu
                                overlay="true"
                                trigger="sendemail_cc"
                                widgetVar="widget_sendemail_cc"
                                my="left top"
                                at="left bottom"
                                model="#{issueController.selects.get('d_o_users')}"
                                styleClass="tieredMenu_d_o_users"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column styleClass="td_15 td_text_align_left">
                            File
                        </p:column>
                        <p:column styleClass="td_text_align_left">
                            <p:fileUpload label="#{msg['label.btn.upload']}" fileUploadListener="#{sendEmailController.handleFileUpload}"
                                              mode="advanced" auto="true" dragDropSupport="false"
                                              multiple="false" sizeLimit="#{layout.sizeLimitUpload}"
                                              allowTypes="#{layout.allowTypetUpload}"
                                              style="background: none;border: none;"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column styleClass="td_15 td_text_align_left">
                            <h:outputLabel value="#{mailBundle['label.sent.dialog.from_issue.request_type']}" />
                        </p:column>
                        <p:column styleClass="td_text_align_left">
                            <p:selectOneMenu value="#{sendEmailController.mailRequestType}">
                                <p:ajax event="change" process="@form" update=":form_todo:body" listener="#{sendEmailController.onRequestTypeChange}"/>
                                <f:selectItem itemValue="" itemLabel="--"/>
                                <f:selectItems value="#{sendEmailController.lstMailRequestType}"/>
                            </p:selectOneMenu>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column styleClass="td_15 td_text_align_left">
                            <h:outputLabel value="#{msg['label.mail.subject']}" />
                        </p:column>
                        <p:column styleClass="td_text_align_left">
                            <p:inputText value="#{sendEmailController.subject}">
                                <f:validator validatorId="gnext.validator.RequiredValidator" />
                                <f:attribute name="title" value="#{msg['label.mail.subject']}"/>
                            </p:inputText>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column colspan="2">
                            <p:inputTextarea id="body" styleClass="input_text_98" rows="5" autoResize="false" value="#{sendEmailController.body}">
                                <f:validator validatorId="gnext.validator.RequiredValidator" />
                                <f:attribute name="title" value="Mail Body"/>
                            </p:inputTextarea>
                        </p:column>
                    </p:row>
                </p:panelGrid>
                <p:selectBooleanCheckbox styleClass="selectBooleanCheckbox_todo" />
            </h:form>
        </h:body>
        
        <h:outputScript>
            <script type="text/javascript">
                jQuery(document).ready(function ($) {
                    addCheckBoxToMenu('tieredMenu_d_o_users', 'form_todo', null);
                    $('.selectBooleanCheckbox_todo').hide()
                });
            </script>
        </h:outputScript>
        
    </f:view>
</html>