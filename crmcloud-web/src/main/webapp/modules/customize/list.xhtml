<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:pe="http://primefaces.org/ui/extensions">
    <div id="pageTitle">#{customize['label.page.title']} #{msg['symbol.paren.left']}#{customize['label.page.description']}#{msg['symbol.paren.right']}</div>
    <h:form>
        <h:panelGrid width="100%" styleClass="page-header">
            <f:facet name="header">
                <!-- Content Header (Page header) -->
                <div class="row">
                    <div class="col-md-6">
                        <h1>
                            #{customize['label.page.title']}
                            <small>#{customize['label.page.description']}</small>
                        </h1>
                    </div>
                    <div class="col-md-6 text-right">
                        <p:commandButton value="#{msg['label.reload']}" actionListener="#{customizeController.reload()}" update="mainContent" title="#{msg['label.reload']}" 
                                         icon="fa fa-refresh" onstart="start()" onsuccess="finish()"
                                         rendered="#{sec.hasMethod('CustomizeController', 'view')}"/>
                        <p:commandButton value="#{msg['label.create']}" actionListener="#{customizeController.showCreateForm}" 
                                         update="mainContent" title="#{msg['label.create']}" 
                                         icon="fa fa-plus-circle" onstart="start()" onsuccess="finish()"
                                         rendered="#{sec.hasMethod('CustomizeController', 'create') and empty customizeController.pageList}">
                            <f:param name="force" value="true"/>
                        </p:commandButton>
                        <p:commandButton value="#{msg['label.download']}" title="#{msg['label.download']}" icon="fa fa-cloud-download"
                                       action="#{groupController.download('pageTabTable','customize')}" ajax="false"
                                       rendered="${sec.hasMethod('CustomizeController', 'download')}">
                        </p:commandButton>
                    </div>
                </div>
            </f:facet>
        </h:panelGrid>

        <c:set var="rowsPerPageTemplate" value="#{configController.getConfig('DATATABLE_ROW_PER_PAGE')}" scope="session" />
        <c:set var="rows" value="#{configController.getConfig('DATATABLE_DEFAULT_PER_PAGE')}" scope="session" />
        <p:dataTable id="pageTabTable" var="p" rowIndexVar="itemViewIndex" value="#{customizeController.pageList}" scrollable="true"
            lazy="true" paginator="true" paginatorTemplate="#{layout.paginatorTemplate}" currentPageReportTemplate="#{layout.currentPageReportTemplate}"
            rowsPerPageTemplate="#{rowsPerPageTemplate}" rows="#{rows}" pageLinks="5" rowHover="true" emptyMessage="#{msg['label.data.empty']}">
            <p:column style="width:50px" styleClass="table-action" exportable="false">
                <div class="btn-group">
                    <button type="button" class="btn btn-success btn-xs dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                        <span class="fa fa-cog"></span>
                    </button>
                    <ul class="dropdown-menu">
<!--                        <li>
                            <p:commandLink actionListener="#{renderController.renderForm(p, p.pageId)}"
                               update="mainContent" value="#{msg['label.show']}"
                               title="#{msg['label.show']}" styleClass="fa fa-search"
                               rendered="#{sec.hasMethod('CustomizeController', 'view')}"
                               onstart="start()" onsuccess="finish()"/>
                        </li>-->
                        <li>
                            <p:commandLink actionListener="#{customizeController.showUpdateForm(p, itemViewIndex)}"
                               update="mainContent" value="#{msg['label.edit']}"
                               title="#{msg['label.edit']}" styleClass="fa fa-pencil"
                               rendered="#{sec.hasMethod('CustomizeController', 'update')}"
                               onstart="start()" onsuccess="finish()" >
                                <f:param name="force" value="true"/>
                            </p:commandLink>
                        </li>
                        <li>
                            <p:commandLink actionListener="#{customizeController.remove(p)}"
                               update=":growl, mainContent" value="#{msg['label.delete']}"
                               title="#{msg['label.delete']}" styleClass="fa fa-trash"
                               rendered="#{sec.hasMethod('CustomizeController', 'delete')}"
                               onstart="start()" onsuccess="finish()">
                                <p:confirm header="#{msg['label.confirm']}" message="#{msg['label.confirm.delete']}" icon="ui-icon-alert" />
                            </p:commandLink>
                        </li>
                    </ul>
                </div>
            </p:column>
            
            <p:column>
                <f:facet name="header">  
                    <h:outputText value="#{customize['label.table.name']}"/>  
                </f:facet> 
                <p:commandLink actionListener="#{customizeController.showUpdateForm(p, itemViewIndex)}"
                               update="mainContent" value="#{customizeController.getPageName(p)}"
                               styleClass="link"
                               title="#{msg['label.edit']}"
                               rendered="#{sec.hasMethod('CustomizeController', 'update')}"
                               onstart="start()" onsuccess="finish()" />
            </p:column>
            
            <p:column style="width:120px; text-align: center">
                <f:facet name="header">  
                    <h:outputText value="#{customize['label.table.type']}"/>  
                </f:facet> 
                <p:outputLabel value="#{customize['label.customize.pagetype.'.concat(p.pageType)]}" 
                               styleClass="#{not p.dynamic ? 'label label-info' : ' label label-success'}" />
            </p:column>

            <p:column rendered="#{sec.master}" style="width:300px;">
                <f:facet name="header">  
                    <h:outputText value="#{customize['label.table.company']}"/>  
                </f:facet> 
                <h:outputText value="#{p.company.companyName}" />
            </p:column>

            <p:column style="width:180px">
                <f:facet name="header">  
                    <h:outputText value="#{customize['label.table.time']}"/>  
                </f:facet> 
                <h:outputText value="#{p.updatedTime}">
                    <f:convertDateTime type="date" pattern="yyyy-MM-dd"/>
                </h:outputText>
            </p:column>

            
        </p:dataTable>
        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
            <p:commandButton value="#{msg['label.yes']}" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
            <p:commandButton value="#{msg['label.no']}" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
        </p:confirmDialog>
    </h:form>
</ui:composition>

