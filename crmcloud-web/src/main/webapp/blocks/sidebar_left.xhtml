<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <ui:composition>
        <h:form id="sidebarLeft" prependId="false">
            <section class="sidebar" id="sidebar">
                <ul class="sidebar-menu" id="sidebar-menu">
                    
                    <!--///////////////////////////// PROJECTS /////////////////////////////-->
                    <li class="header">
                        <i class="fa fa-list" aria-hidden="true"></i> &nbsp;&nbsp;#{msg['label.sidebar.project']}
                        <h:outputFormat rendered="#{sec.isMaster() or sec.hasMethod('ProjectController', 'CREATE') or sec.hasMethod('ProjectController', 'UPDATE')}">
                            <p:commandLink actionListener="#{projectController.create(1)}" styleClass="add-project-item-action"  
                                           update="mainContent" onstart="start()" onsuccess="finish()" 
                                           rendered="#{sec.hasMethod('ProjectController', 'create')}" style="display: none">
                                <f:param name="force" value="true"/>
                            </p:commandLink>
                            <i class="fa fa-times close-edit-project pull-right" style="display: none" name="edit_project_1"></i>
                            <i class="fa fa-pencil-square-o edit-project pull-right" ref="none" name="edit_project_1"></i>
                        </h:outputFormat>
                    </li>
                    <p:outputPanel id="menuListGroup" class="sidebar-menu cf">
                        <li class="treeview active" id="projectTree">
                            <ul class="treeview-menu menu-open">
                                <ui:include src="/modules/sidebar/project.xhtml">
                                    <ui:param name="list" value="#{projectController.projects}"/>
                                </ui:include>
                            </ul>
                        </li>
                    </p:outputPanel>

                    <!--///////////////////////////// SEARCHES /////////////////////////////-->
                    <li class="header">
                        <i class="fa fa-search" aria-hidden="true"></i> &nbsp;&nbsp;#{msg['label.sidebar.search']}
                        <h:outputFormat rendered="#{sec.isMaster() or sec.hasMethod('ProjectController', 'CREATE') or sec.hasMethod('ProjectController', 'UPDATE')}">
                            <p:commandLink actionListener="#{projectController.create(3)}" styleClass="add-project-item-action"  
                                           update="mainContent" onstart="start()" onsuccess="finish()" 
                                           rendered="#{sec.hasMethod('ProjectController', 'create')}" style="display: none">
                                <f:param name="force" value="true"/>
                            </p:commandLink>
                            <i class="fa fa-times close-edit-project pull-right" style="display: none" name="edit_project_3"></i>
                            <i class="fa fa-pencil-square-o edit-project pull-right" ref="none" name="edit_project_3"></i>
                        </h:outputFormat>
                    </li>
                    <p:outputPanel id="menuSearchGroup" class="sidebar-menu cf">
                        <li class="treeview active" id="projectTree">
                            <ul class="treeview-menu menu-open">
                                <ui:include src="/modules/sidebar/project_searches.xhtml">
                                    <ui:param name="list" value="#{projectController.searches}"/>
                                </ui:include>
                            </ul>
                        </li>
                    </p:outputPanel>

                    <c:choose>
                        <c:when test="#{loginController.member.companyCustomerMode}">
                            <h:outputLabel id="todoListGroup" style="display: none;"/>
                        </c:when>
                        <c:otherwise>
                            <!--///////////////////////////// TODO /////////////////////////////-->
                            <li class="header todo-list-header">
                                <i class="fa fa-check-square-o" aria-hidden="true"></i> &nbsp;&nbsp;TODO
                                <p:commandLink actionListener="#{issueTodoController.init()}" styleClass="hide reload-todo-list" 
                                               update="todoListGroup" 
                                               onstart="start('#sidebar .todo-list-header .fa-refresh')" 
                                               onsuccess="finish('#sidebar .todo-list-header .fa-refresh')">
                                    <f:param name="force" value="true"/>
                                </p:commandLink>
                                <i class="fa fa-refresh pull-right hover cmd-remote-command" cmd=".reload-todo-list" aria-hidden="true"></i>
                            </li>
                            <p:outputPanel id="todoListGroup" class="sidebar-menu sidebar-todo cf">
                                <h:outputFormat rendered="#{sec.isMaster() or sec.hasMethod('IssueTodoController', 'SEARCH')}">
                                <li class="treeview active text-center" id="todoTree">
                                    <ul class="treeview-menu menu-open text-left">
                                        <ui:include src="/modules/sidebar/todo.xhtml"/>
                                    </ul>
                                </li>
                                </h:outputFormat>
                            </p:outputPanel>
                        </c:otherwise>
                    </c:choose>

                    <!--///////////////////////////// LAMP /////////////////////////////-->
                    <p:outputPanel id="issueLamp" class="sidebar-menu cf">
                        <li class="treeview active" >
                            <ul class="treeview-menu menu-open">
                                <ui:include src="/modules/sidebar/issuelamp.xhtml"/>
                            </ul>
                        </li>
                    </p:outputPanel>
                </ul>
            </section>
            <h:outputScript>
                jQuery(document).ready(function($){
                    // slibar decorator
                    CRMCLOUD.binding_edit_project();
                    CRMCLOUD.binding_close_edit_project();
                });
            </h:outputScript>
        </h:form>
    </ui:composition>
</html>
